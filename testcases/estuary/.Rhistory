title('dissolved oxygen concentration mmol-O2 L-1',adj=0,line=0.1,cex=0.5,font.main=1)
#lines(x,oxy[,bottom],lty=3,col='red')
lines(x,oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
points(as.Date(oxy.w.1$V1),(1000/32)*oxy.w.1$V2,col=alpha(col.obs,0.5),pch=20,cex=1.)
points(as.Date(oxy.w.2$V1),(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
sdfasd
date.range=c('2012-06-01','2012-08-01')
plot(temp.w.3$V1,temp.w.3$V2,type='l',
ylim=c(0,25),
xlim= as.POSIXct(date.range)
)
lines(as.POSIXct(x),temp[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
plot(oxy.w.1$V1,(1000/32)*oxy.w.1$V2,type='p',
pch=20,cex=1.,
ylim=c(0,500),
xlim= as.POSIXct(date.range)
)
points(oxy.w.2$V1,(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
lines(as.POSIXct(x),oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
fsedafsdf
plot(x,rowMeans(nut),type='l',col='black',ylim=c(1,50),log='y',
ylab='',
xlab='days',
main='mean DIN')
lines(x,nut[,70],type='l',col='black',lwd=1,lty=2)
plot(x,conv.fact*rowSums(phy),type='l',col='black',ylim=c(0.1,5e4),log='y')
title(main='diatoms')
plot(x,conv.fact*rowSums(zoo),type='l',col='black',ylim=c(.02,20),log='y')
title(main='copepods')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
library(ncdf4)
library(graphics)
library(scales)
library(lubridate)
library(cmocean)
conv.fact = 12
#source("~/tools/dobgcp-surface/testcase/estuary/data/setup_data.R", echo=TRUE)
setwd('/home/og/tools/dobgcp-surface/testcase/estuary/')
par(las=1,family='carlito')
nc_data = nc_open('output.nc')
plot.contour  = function(my.data,title=NA,cs='Vir',.rev=F,norm=F){
x = 1:length(my.data[,1])
y = 1:length(my.data[1,])
xrange=range(x)
n=0
xrange=c(n*365,(n+1)*366)
plot(1,type='n',xlim=xrange,ylim=c(0,max(y)),
xlab='month',
ylab='depth, m',
yaxt='n',xaxt='n',
main='')
title(main=title,adj=0)
axis(side=2,at=c(0,0.5,1)*max(y),label=abs(c(0,150,300)-300),las=1)
axis.Date(side=1,at=as.Date(paste0('1970-',1:12,'-01')),labels = NA)
axis.Date(side=1,at=as.Date(paste0('1971-',1:12,'-01')),labels = NA)
the.levels=pretty(my.data,n=200)
if(norm) the.levels = seq(0,1,length.out=200)
#my.cols= hcl.colors((length(the.levels)-1), cs, rev = .rev)
my.cols = cmocean(cs)(length(the.levels)-1)
#.filled.contour(-0.5+x,-0.5+y,my.data,levels=the.levels,col=my.cols)
image(-0.5+x,-0.5+y,my.data,col=my.cols,add=T,use.raster=T)
}
plot.contour.sim = plot.contour
par(mfrow=c(2,2))
if(F) for(i in 1:nc_data$nvars){
v1 = nc_data$var[[i]]
data1 = ncvar_get(nc_data, v1)	# by default, reads ALL the data
print(paste("Data for var ",v1$name,":",sep=""))
if(substr(v1$name, start = 1, stop = 2)!='nn') next
nn =  t(ncvar_get(nc_data, v1$name))
plot.contour(nn,title=v1$name,cs='thermal')
}
#stop-here
if(F){
temp =  t(ncvar_get(nc_data, "temp"))
nut =  t(ncvar_get(nc_data, "bgc_PO4"))
phy =  t(ncvar_get(nc_data, "bgc_ALG1"))
zoo =  t(ncvar_get(nc_data, "bgc_DOC"))
det =  t(ncvar_get(nc_data, "bgc_POC1"))
par =  t(ncvar_get(nc_data, "bgc_PAR"))
oxy =  t(ncvar_get(nc_data, "bgc_DOxy"))
salt =  t(ncvar_get(nc_data, "salt"))
}else{
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
salt =  t(ncvar_get(nc_data, "salt"))
}
if(T){
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=T)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=T)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy',.rev=T)
plot.contour(salt,title = 'salinity',cs='haline',.rev=T)
}
x = 1:length(temp[,1])#%%12+1
temp =  t(ncvar_get(nc_data, "temp"))
temp =  t(ncvar_get(nc_data, "temp"))
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=T)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=T)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy',.rev=T)
plot.contour(salt,title = 'salinity',cs='haline',.rev=T)
nc_data = nc_open('output.nc')
if(F) for(i in 1:nc_data$nvars){
v1 = nc_data$var[[i]]
data1 = ncvar_get(nc_data, v1)	# by default, reads ALL the data
print(paste("Data for var ",v1$name,":",sep=""))
if(substr(v1$name, start = 1, stop = 2)!='nn') next
nn =  t(ncvar_get(nc_data, v1$name))
plot.contour(nn,title=v1$name,cs='thermal')
}
if(T) for(i in 1:nc_data$nvars){
v1 = nc_data$var[[i]]
data1 = ncvar_get(nc_data, v1)	# by default, reads ALL the data
print(paste("Data for var ",v1$name,":",sep=""))
if(substr(v1$name, start = 1, stop = 2)!='nn') next
nn =  t(ncvar_get(nc_data, v1$name))
plot.contour(nn,title=v1$name,cs='thermal')
}
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
salt =  t(ncvar_get(nc_data, "salt"))
#stop-here
if(F){
temp =  t(ncvar_get(nc_data, "temp"))
nut =  t(ncvar_get(nc_data, "bgc_PO4"))
phy =  t(ncvar_get(nc_data, "bgc_ALG1"))
zoo =  t(ncvar_get(nc_data, "bgc_DOC"))
det =  t(ncvar_get(nc_data, "bgc_POC1"))
par =  t(ncvar_get(nc_data, "bgc_PAR"))
oxy =  t(ncvar_get(nc_data, "bgc_DOxy"))
salt =  t(ncvar_get(nc_data, "salt"))
}else{
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
salt =  t(ncvar_get(nc_data, "salt"))
}
if(T){
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=T)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=T)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy',.rev=T)
plot.contour(salt,title = 'salinity',cs='haline',.rev=T)
}
x = 1:length(temp[,1])#%%12+1
x = as.Date(x,origin='2006-01-01')
surface=length(par[1,])-1
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=F)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=F)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=T)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=F)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',.rev=F)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(salt,title = 'salinity',cs='haline',.rev=T)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae',rev=T)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
image(oxy)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot(oxy.w.1$V1,(1000/32)*oxy.w.1$V2,type='p',
pch=20,cex=1.,
ylim=c(0,500),
xlim= as.POSIXct(date.range)
)
points(oxy.w.2$V1,(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
plot(x,rowMeans(temp[,bottom:surface]),type='n',
col=alpha(col.obs,0.5),ylim=c(-5,25),log='',lwd=0.5,
ylab='',
xlab='days'
)
title('temperature at the surface degC',adj=0,line=0.1,cex=0.5,font.main=1)
#lines(x,temp[,bottom],lty=3,col='red')
lines(x,temp[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
#lines(x,oxy[,bottom],lty=3,col='red')
lines(x,oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
plot(x,rowMeans(oxy[,1:2]),type='n',
col=alpha(col.obs),ylim=c(00,500),log='',lwd=0.5,
ylab='',
xlab='days',
)
title('dissolved oxygen concentration mmol-O2 L-1',adj=0,line=0.1,cex=0.5,font.main=1)
#lines(x,oxy[,bottom],lty=3,col='red')
lines(x,oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
points(as.Date(oxy.w.1$V1),(1000/32)*oxy.w.1$V2,col=alpha(col.obs,0.5),pch=20,cex=1.)
points(as.Date(oxy.w.2$V1),(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
plot(x,rowMeans(oxy[,1:2]),type='n',
col=alpha(col.obs),ylim=c(100,500),log='',lwd=0.5,
ylab='',
xlab='days',
)
title('dissolved oxygen concentration mmol-O2 L-1',adj=0,line=0.1,cex=0.5,font.main=1)
#lines(x,oxy[,bottom],lty=3,col='red')
lines(x,oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
points(as.Date(oxy.w.1$V1),(1000/32)*oxy.w.1$V2,col=alpha(col.obs,0.5),pch=20,cex=1.)
points(as.Date(oxy.w.2$V1),(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
plot(x,rowMeans(oxy[,1:2]),type='n',
col=alpha(col.obs),ylim=c(100,500),log='',lwd=0.5,
ylab='',
xlab='days',
)
title('dissolved oxygen concentration mmol-O2 L-1',adj=0,line=0.1,cex=0.5,font.main=1)
#lines(x,oxy[,bottom],lty=3,col='red')
lines(x,oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
points(as.Date(oxy.w.1$V1),(1000/32)*oxy.w.1$V2,col=alpha(col.obs,0.5),pch=20,cex=1.)
points(as.Date(oxy.w.2$V1),(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(par,title='PAR',cs='solar')
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(salt,title = 'salinity',cs='haline')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
nc_data = nc_open('output.nc')
plot.contour  = function(my.data,title=NA,cs='Vir',.rev=F,norm=F){
x = 1:length(my.data[,1])
y = 1:length(my.data[1,])
xrange=range(x)
n=0
xrange=c(n*365,(n+1)*366)
plot(1,type='n',xlim=xrange,ylim=c(0,max(y)),
xlab='month',
ylab='depth, m',
yaxt='n',xaxt='n',
main='')
title(main=title,adj=0)
axis(side=2,at=c(0,0.5,1)*max(y),label=abs(c(0,150,300)-300),las=1)
axis.Date(side=1,at=as.Date(paste0('1970-',1:12,'-01')),labels = NA)
axis.Date(side=1,at=as.Date(paste0('1971-',1:12,'-01')),labels = NA)
the.levels=pretty(my.data,n=200)
if(norm) the.levels = seq(0,1,length.out=200)
#my.cols= hcl.colors((length(the.levels)-1), cs, rev = .rev)
my.cols = cmocean(cs)(length(the.levels)-1)
#if(.rev) my.cols = rev(my.cols)
#.filled.contour(-0.5+x,-0.5+y,my.data,levels=the.levels,col=my.cols)
image(-0.5+x,-0.5+y,my.data,col=my.cols,add=T,use.raster=T)
}
plot.contour.sim = plot.contour
par(mfrow=c(2,2))
if(T) for(i in 1:nc_data$nvars){
v1 = nc_data$var[[i]]
data1 = ncvar_get(nc_data, v1)	# by default, reads ALL the data
print(paste("Data for var ",v1$name,":",sep=""))
if(substr(v1$name, start = 1, stop = 2)!='nn') next
nn =  t(ncvar_get(nc_data, v1$name))
plot.contour(nn,title=v1$name,cs='thermal')
}
#stop-here
if(F){
temp =  t(ncvar_get(nc_data, "temp"))
nut =  t(ncvar_get(nc_data, "bgc_PO4"))
phy =  t(ncvar_get(nc_data, "bgc_ALG1"))
zoo =  t(ncvar_get(nc_data, "bgc_DOC"))
det =  t(ncvar_get(nc_data, "bgc_POC1"))
par =  t(ncvar_get(nc_data, "bgc_PAR"))
oxy =  t(ncvar_get(nc_data, "bgc_DOxy"))
salt =  t(ncvar_get(nc_data, "salt"))
}else{
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
salt =  t(ncvar_get(nc_data, "salt"))
}
if(F){
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(salt,title = 'salinity',cs='haline')
}
if(F){
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(salt,title = 'salinity',cs='haline')
}
x = 1:length(temp[,1])#%%12+1
x = as.Date(x,origin='2006-01-01')
surface=length(par[1,])-1
bottom = 1
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
par(mfrow=c(2,2))
if(T) for(i in 1:nc_data$nvars){
v1 = nc_data$var[[i]]
data1 = ncvar_get(nc_data, v1)	# by default, reads ALL the data
print(paste("Data for var ",v1$name,":",sep=""))
if(substr(v1$name, start = 1, stop = 2)!='nn') next
nn =  t(ncvar_get(nc_data, v1$name))
plot.contour(nn,title=v1$name,cs='thermal')
}
#stop-here
if(F){
temp =  t(ncvar_get(nc_data, "temp"))
nut =  t(ncvar_get(nc_data, "bgc_PO4"))
phy =  t(ncvar_get(nc_data, "bgc_ALG1"))
zoo =  t(ncvar_get(nc_data, "bgc_DOC"))
det =  t(ncvar_get(nc_data, "bgc_POC1"))
par =  t(ncvar_get(nc_data, "bgc_PAR"))
oxy =  t(ncvar_get(nc_data, "bgc_DOxy"))
salt =  t(ncvar_get(nc_data, "salt"))
}else{
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
salt =  t(ncvar_get(nc_data, "salt"))
}
temp =  t(ncvar_get(nc_data, "temp"))
phy =  t(ncvar_get(nc_data, "diamo_PHY"))
det =  t(ncvar_get(nc_data, "diamo_DET"))
par =  t(ncvar_get(nc_data, "diamo_PAR"))
oxy =  t(ncvar_get(nc_data, "diamo_OXY"))
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
if(T){
par(mfrow=c(2,3),mai=c(0.2,0.2,0.1,0.1),oma=2*c(1,1,0.5,0.5))
plot.contour(temp,title='Temperature ()',cs='thermal')
plot.contour(par,title='PAR',cs='solar')
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour(log10(phy),title='Phytoplankton',cs='algae')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',.rev=T)
plot.contour(oxy,title = 'Oxygen',cs='oxy')
plot.contour(salt,title = 'salinity',cs='haline')
}
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter',)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='matter')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='')
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour(log10(det),title = 'Detritus',cs='turbid')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
#plot.contour(zoo,title = 'Zooplankton',cs='matter',.rev=F)
plot.contour((det),title = 'Detritus',cs='turbid')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
#plot.contour(log10(nut),title='Nutrient',cs='dense',.rev=T)
plot.contour((phy),title='Phytoplankton',cs='algae')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
date.range=c('2012-06-01','2012-08-01')
plot(temp.w.3$V1,temp.w.3$V2,type='l',
ylim=c(0,25),
xlim= as.POSIXct(date.range)
)
lines(as.POSIXct(x),temp[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
plot(oxy.w.1$V1,(1000/32)*oxy.w.1$V2,type='p',
pch=20,cex=1.,
ylim=c(0,500),
xlim= as.POSIXct(date.range)
)
points(oxy.w.2$V1,(1000/32)*oxy.w.2$V2,col=alpha(col.obs2,0.5),pch=20,cex=1.)
lines(as.POSIXct(x),oxy[,surface],lty=1,col=alpha(col.sim,1),lwd=2)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
plot(x,rowMeans(nut),type='l',col='black',ylim=c(1,50),log='y',
ylab='',
xlab='days',
main='mean DIN')
lines(x,nut[,70],type='l',col='black',lwd=1,lty=2)
plot(x,conv.fact*rowSums(phy),type='l',col='black',ylim=c(0.1,5e4),log='y')
title(main='diatoms')
plot(x,conv.fact*rowSums(zoo),type='l',col='black',ylim=c(.02,20),log='y')
title(main='copepods')
plot(x,conv.fact*rowSums(zoo),type='l',col='black',ylim=c(.0002,20),log='y')
title(main='copepods')
plot(x,conv.fact*rowSums(zoo),type='l',col='black',ylim=c(.0002,20000),log='y')
title(main='copepods')
plot(x,rowMeans(nut),type='l',col='black',ylim=c(1,50),log='y',
ylab='',
xlab='days',
main='mean DIN')
lines(x,nut[,70],type='l',col='black',lwd=1,lty=2)
plot(x,conv.fact*rowSums(phy),type='l',col='black',ylim=c(0.1,5e4),log='y')
title(main='diatoms')
plot(x,conv.fact*rowSums(det),type='l',col='black',ylim=c(.0002,20000),log='y')
title(main='copepods')
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
source("~/tools/dobgcp-surface/testcase/estuary/plot_output.R", echo=TRUE)
